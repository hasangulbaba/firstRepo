<!DOCTYPE html>
<html>
<head>
 <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
<link rel="stylesheet" type="text/css" href="site_theme.css">
<meta charset="UTF-8"/>

<title>Website Project</title>
<script src="database.js"></script>

<nav>
  <ul class="nav">
    <li><a href="https://hasangulbaba.github.io/firstRepo/ileriProje/deneme.html" style="float:initial;">ANASAYFA</a></li>
    <li><a href="#">TÜRLER</a>
      <ul>
        <li><a href="#" onClick="showLinkElements('macera','')">MACERA</a>
	
	</li>
        <li><a href="#"  onClick="showLinkElements('polisiye', '')">POLİSİYE</a>
	
	</li>
        <li><a href="#" onClick="showLinkElements('bilim_kurgu','')">BİLİM KURGU</a>
	
	</li>
        <li><a href="#" onClick="showLinkElements('tarih','')">TARİH</a>
	
	</li>
      </ul>
    </li>
    <li><a href="#" id="button_search" onClick="searchingVisibility()">KİTAP ARA</a></li>
    <li><a href="https://hasangulbaba.github.io/firstRepo/ileriProje/kitaplar.html">KİTAPLAR</a></li>
    <li><a href="https://hasangulbaba.github.io/firstRepo/ileriProje/admin.html">ADMİN</a></li>
    <li><a href="https://hasangulbaba.github.io/firstRepo/ileriProje/iletisim.html">İLETİŞİM</a></li>
  </ul>
</nav><br>
<style>
  table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}
</style>
<script>
function searchingVisibility() {
	var searching = document.getElementById("input_search");
	searching.style.visibility = "visible";
}
function searchingVisibilityHidden() {
	var searching_input = document.getElementById("input_search");
	searching_input.style.visibility = "hidden";
}
</script>
</head>
<body>
<form>
	<center style="visibility:hidden;" id="input_search">
	  	<input  type="text" placeholder="Search.." onkeypress="searcher(this.value)"><br>
		<fieldset style="width:45%;">
		</fieldset>
	</center>
</form><br>
<center>
<div id="myTable" style="display:inline;">
</div>
</center>

<script>
const database = new Database();
var elements = "";
const url = "https://hasangulbaba.github.io/firstRepo/ileriProje/text_files/";
function readData(file) {
    console.log("readData "+file);
    if(file.includes("kitaplar.txt")) {
      fetch(url+file)
          .then(r => r.text())
          .then(addKitap).then(makeRows);
    } 
    else if(file.includes("favoriler.txt")) {
      fetch(url+file)
          .then(r => r.text())
          .then(addIsyeri).then(showIsyeriElements);
    }
    else if(file.includes("uyeler.txt")) {
      fetch(url+file)
          .then(r => r.text())
          .then(addBina).then(showBinaElements);
    } 
    else {
	console.log("File could not find.")
    }
}

function parse(line) {
    let b = line.split("\t");
    return b;
}
function addKitap(txt) {
    let a = txt.split("\n");
    
	for (let s of a) {
		let std = parse(s);
		database.kitap.set(std[0],[std[1],std[2],std[3]]); //kitap adı,yazar,tür
		
	}
}

function diziyeEkle() {
   for (let b of database.kitap.keys()) {
			
		for (let i = 0; i < database.kitap.size; i++) {
      	console.log(database.kitap.get(b)[i]);
       }
	}
}
readData("kitaplar.txt");
var phone = [

{kitap:"hasan",yazar:"pilotluk tarihi",tür:"gs yayınevi"},

];

function makeRows() {
    let row = "<th></th>";
    for (let q of Object.keys(phone[0])){ 
        row += "<th>"+q+"</th>";
		}
    let text = "<tr>"+row+"</tr>";
    for (let i = 0; i < database.kitap.size; i++) {
       row = "<th>"+i+"</th>";
       for (let b of database.kitap.keys()) {
			
		
      		row += "<td>"+database.kitap.get(b)[i]+"</td>";
       
	   }
       text += "<tr>"+row+"</tr>";
	   
    }
    const t = text.length+" chars";
    
    tablo.innerHTML = text; out.innerText = t; 
}
function kitapYaz(){




}


//burası seçilen türlerin gelme yeri
function showLinkElements(mapName, aranacak_metin) {
    let row = "";
    if (mapName == "isyeri") {
	    for (let b of database.isyeri.keys()) {
		    if (database.isyeri.get(b).includes(aranacak_metin) || aranacak_metin == "")
		    	row += '<div id="' + b + '' + database.isyeri.get(b)[0] + '" class="card"><img src="' + database.isyeri.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.isyeri.get(b)[3] + '</h2><p class="price">' + database.isyeri.get(b)[2] + ' TL</p><p>' + database.isyeri.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
	    }
    } else if (mapName == "arsa") {
	    for (let b of database.arsa.keys()) {
		    if (database.arsa.get(b).includes(aranacak_metin) || aranacak_metin == "")
		    	row += '<div id="' + b + '' + database.arsa.get(b)[0] + '" class="card"><img src="' + database.arsa.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.arsa.get(b)[3] + '</h2><p class="price">' + database.arsa.get(b)[2] + ' TL</p><p>' + database.arsa.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
	    }
    } else if (mapName == "bina") {
	    for (let b of database.bina.keys()) {
		    if (database.bina.get(b).includes(aranacak_metin) || aranacak_metin == "")
		    	row += '<div id="' + b + '' + database.bina.get(b)[0] + '" class="card"><img src="' + database.bina.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.bina.get(b)[3] + '</h2><p class="price">' + database.bina.get(b)[2] + ' TL</p><p>' + database.bina.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
	    }
    } else if (mapName == "konut") {
	    for (let b of database.konut.keys()) {
		    if (database.konut.get(b).includes(aranacak_metin) || aranacak_metin == "")
		    	row += '<div id="' + b + '' + database.konut.get(b)[0] + '" class="card"><img src="' + database.konut.get(b)[1]  + '" style="width:100%"> <h2 style="min-height:200px">' + database.konut.get(b)[3] + '</h2><p class="price">' + database.konut.get(b)[2] + ' TL</p><p>' + database.konut.get(b)[4] + '</p> <p><button>İncele</button></p></div>';   
	    }
    }
    myTable.innerHTML = row;
    elements = row;
}
function checkButtonControl() {	
	regexGK = new RegExp(/[0-9]+GK"/g);
	regexK = new RegExp(/[0-9]+K"/g);
	regexS = new RegExp(/[0-9]+S"/g);
	let row = elements;
	row = row.split("</div>");
	let new_row = "";
	for (let i of row) {
		if (c.checked && i.match(regexGK))
			new_row += i + "</div>";
		if (b.checked && i.match(regexK))
			new_row += i + "</div>";
		if (a.checked && i.match(regexS))
			new_row += i + "</div>";			
	}
	myTable.innerHTML = new_row;
}
function searcher(event) {
	let row = elements;
	row = row.split("</div>");
	let new_row = "";
	for (let i of row) {
		if (i.toLowerCase().match(event.toLowerCase())) {
				new_row += i + "</div>";
		}
	}
	console.log(new_row);
	myTable.innerHTML = new_row;
}

</script>
<center>
<table id="tablo"><tbody>
<tr><th></th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th></tr><tr><th>1</th><td>1,1<span class="tip">C1</span></td><td>1,2<span class="tip">C2</span></td><td>1,3<span class="tip">C3</span></td><td>1,4<span class="tip">C4</span></td><td>1,5<span class="tip">C5</span></td></tr><tr><th>2</th><td>2,1<span class="tip">C6</span></td><td>2,2<span class="tip">C7</span></td><td>2,3<span class="tip">C8</span></td><td>2,4<span class="tip">C9</span></td><td>2,5<span class="tip">C10</span></td></tr><tr><th>3</th><td>3,1<span class="tip">C11</span></td><td>3,2<span class="tip">C12</span></td><td>3,3<span class="tip">C13</span></td><td>3,4<span class="tip">C14</span></td><td>3,5<span class="tip">C15</span></td></tr></tbody></table>

<p id="out" style="font-size:small">999 chars</p>


</center>

<script>
    title.innerText = document.title;
    makeRows();
</script>
</body>
</html>
